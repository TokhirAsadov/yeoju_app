/*! For license information please see 9668.770d15db.js.LICENSE.txt */
(self.webpackChunkkiut_client=self.webpackChunkkiut_client||[]).push([["9668"],{26571:function(e,l,t){"use strict";t.r(l);var n=t("58865");t("33948"),t("17727"),t("57640"),t("9924");var r=t("85893"),i=t("67294"),o=t("71893"),a=t("57024"),s=t("44118"),d=t("52861"),u=t("27233"),c=t("16393"),h=t("30381"),m=t.n(h),x=t("96413"),f=t("73871"),b=t("14628"),p=t("53432"),j=t("78951"),g=t("10456");function v(){let e=(0,n._)(["\n    width: 300px;\n    ","\n"]);return v=function(){return e},e}function T(){let e=(0,n._)(["\n    margin: 15px 0 0;\n    padding: 10px 0;\n    display: flex;\n    flex-wrap: wrap;\n    align-items: center;\n    gap: 25px;\n    justify-content: start;\n    ","\n"]);return T=function(){return e},e}function y(){let e=(0,n._)(["\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 20px;\n    padding: 1rem;\n"]);return y=function(){return e},e}let w=o.default.div(v(),(0,a.extrasmall)({width:"80%"})),C=o.default.div(T(),(0,a.extrasmall)({justifyContent:"center"})),S=o.default.div(y());l.default=()=>{let[e,l]=(0,i.useState)([]),[t,n]=(0,i.useState)(!1),[o,a]=(0,i.useState)([]),[h,v]=(0,i.useState)([]),[T,y]=(0,i.useState)(null),[k,D]=(0,i.useState)(!1),[N,R]=(0,i.useState)({date:new Date(c.serverTimeStorage),dateFrom:null,dateTo:null,weekNumber:null,year:null,weekday:null}),[A,M]=(0,i.useState)(m()(c.serverTimeStorage)),{headers:W}=(0,c.getHeaders)(),z=e=>{let l=m()(e).format("YYYY-MM-DD");R({date:e,dateFrom:m()(l).startOf("isoWeek").toDate(),dateTo:m()(l).endOf("isoWeek").toDate(),weekNumber:m()(l).isoWeek(),year:m()(l).year(),weekday:m()(l).day()})};(0,i.useEffect)(()=>{u.default.get("".concat(c.BASE_URL,"/room/getRoomsForSelect"),{headers:W}).then(e=>{var t;return l((null===(t=e.data)||void 0===t?void 0:t.obj)||[])}).catch(()=>{})},[]);let F=()=>{T&&N.weekNumber&&(D(!0),u.default.get("".concat(c.BASE_URL,"/timeTableByWeekOfYear/getTimeTableByRoom"),{params:{r:T,week:N.weekNumber,weekday:N.weekday,year:N.year},headers:W}).then(e=>{var l,t;a((null===(l=e.data)||void 0===l?void 0:l.obj)||[]),v((null===(t=e.data)||void 0===t?void 0:t.secondObj)||[]),n(!1)}).catch(()=>n(!0)).finally(()=>D(!1)))};return(0,i.useEffect)(()=>{F()},[T,N]),(0,i.useEffect)(()=>{z(A)},[A]),(0,r.jsxs)(S,{children:[(0,r.jsxs)(C,{children:[(0,r.jsx)(w,{children:(0,r.jsx)(s.default,{disablePortal:!0,id:"combo-box-demo",options:e.map(e=>({label:e.label})),onChange:(e,l)=>y((null==l?void 0:l.label)||null),sx:{width:300},renderInput:e=>(0,r.jsx)(d.default,{...e,label:"Auditory"})})}),(0,r.jsx)(w,{children:(0,r.jsx)(f.LocalizationProvider,{dateAdapter:x.AdapterMoment,children:(0,r.jsx)(b.DesktopDatePicker,{label:"Day",inputFormat:"DD/MM/YYYY",value:A,onChange:e=>M(e),renderInput:e=>(0,r.jsx)(d.default,{...e,sx:{width:300}})})})})]}),k?(0,r.jsx)(p.default,{}):t?(0,r.jsx)(j.default,{w:"200",h:"180"}):(0,r.jsx)(g.default,{obj:o,secondObj:h,date:N})]})}},26457:function(e,l,t){"use strict";t.r(l);var n=t("58865");t("31672"),t("59461"),t("2490"),t("88449"),t("19894"),t("57640"),t("9924");var r=t("85893"),i=t("67294"),o=t("7104"),a=t("71893"),s=t("26178"),d=t("78951"),u=t("30381"),c=t.n(u),h=t("50533"),m=t("5434"),x=t("51649");function f(){let e=(0,n._)(["\n    color: ",";\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 5px;\n"]);return f=function(){return e},e}let b=(0,i.forwardRef)(function(e,l){return(0,r.jsx)(o.Slide,{direction:"up",ref:l,...e})}),p=(0,s.createTheme)({components:{MuiTableCell:{styleOverrides:{root:{justifyContent:"center",textAlign:"center",border:"1px solid #ccc",padding:"10px"}}}}}),j=a.default.span(f(),e=>e.color?"green":"red");l.default=(0,i.memo)(e=>{var l,t,n;let{open:i,handleClose:a,data:u}=e,f=(0,h.useSelector)(e=>e.hourSection),g=e=>{var l,t,n;let i=null==e?void 0:e.login,o=null==e?void 0:e.hourNumber,a=null===(l=f.find(e=>e.number===o))||void 0===l?void 0:l.start,s=null==u?void 0:null===(t=u.enterRoomTimeFilterWithoutLogin)||void 0===t?void 0:t.filter(e=>(null==e?void 0:e.section)===o&&(null==e?void 0:e.login)===i).sort((e,l)=>new Date(e.time)-new Date(l.time));if(!s||0===s.length)return(0,r.jsx)(x.IoMdCloseCircle,{size:20,color:"red"});let d=null===(n=s[0])||void 0===n?void 0:n.time,h=new Date(a).setDate(new Date(d).getDate())>=d;return(0,r.jsxs)(j,{color:h,children:[h?(0,r.jsx)(m.MdOutlineAddCircleOutline,{size:16}):(0,r.jsx)(m.MdRemoveCircleOutline,{size:16}),(0,r.jsx)("p",{children:c()(Math.abs(new Date(a).setDate(new Date(d).getDate())-d)).format("mm:ss")})]})};return i&&(0,r.jsxs)(o.Dialog,{open:i,maxWidth:"md",TransitionComponent:b,keepMounted:!0,onClose:a,"aria-labelledby":"selected-lesson-dialog-title",fullWidth:!0,children:[(0,r.jsxs)(o.DialogTitle,{id:"selected-lesson-dialog-title",children:[null==u?void 0:null===(l=u.lessonFilter[0])||void 0===l?void 0:l.room," ",null==u?void 0:null===(t=u.lessonFilter[0])||void 0===t?void 0:t.periodStartAndEndTime]}),(0,r.jsx)(o.DialogContent,{sx:{padding:"0 5px"},children:(0,r.jsx)(s.ThemeProvider,{theme:p,children:(0,r.jsx)(o.TableContainer,{component:o.Paper,children:(0,r.jsxs)(o.Table,{sx:{minWidth:450},"aria-label":"selected-hour-lessons",children:[(0,r.jsx)(o.TableHead,{children:(0,r.jsxs)(o.TableRow,{children:[(0,r.jsx)(o.TableCell,{children:(0,r.jsx)("b",{children:"Teacher"})}),(0,r.jsx)(o.TableCell,{children:(0,r.jsx)("b",{children:"Subjects"})}),(0,r.jsx)(o.TableCell,{children:(0,r.jsx)("b",{children:"Attendance"})})]})}),(0,r.jsx)(o.TableBody,{children:(null==u?void 0:null===(n=u.lessonFilter)||void 0===n?void 0:n.length)?u.lessonFilter.map((e,l)=>(0,r.jsxs)(o.TableRow,{children:[(0,r.jsx)(o.TableCell,{children:null==e?void 0:e.teacherName}),(0,r.jsx)(o.TableCell,{children:null==e?void 0:e.lessonName}),(0,r.jsx)(o.TableCell,{children:g(e)})]},l)):(0,r.jsx)(o.TableRow,{children:(0,r.jsx)(o.TableCell,{colSpan:3,children:(0,r.jsx)(d.default,{w:200,h:180})})})})]})})})}),(0,r.jsx)(o.DialogActions,{children:(0,r.jsx)(o.Button,{size:"small",variant:"outlined",onClick:a,children:"Close"})})]})})},10456:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return b}});var n=t("58865");t("33792"),t("57640"),t("9924"),t("33948"),t("25387"),t("72608"),t("2490"),t("31672"),t("59461"),t("57658"),t("88449"),t("19894");var r=t("85893"),i=t("67294"),o=t("50533"),a=t("7104"),s=t("71893"),d=t("30381"),u=t.n(d),c=t("3506"),h=t("26457"),m=t("16393");function x(){let e=(0,n._)(["\n    cursor: pointer;\n    color: #fff;\n    width: 23px;\n    height: 23px;\n    position: absolute;\n    left: 10px;\n    bottom: 10px;\n    font-size: 12px;\n    border-radius: 50%;\n    background-color: rgba(0, 0, 255, 0.75);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    text-align: center;\n    line-height: 1;\n"]);return x=function(){return e},e}function f(){let e=(0,n._)(["\nposition: absolute;\n    bottom: 10px;\n    right: 10px;\n"]);return f=function(){return e},e}function b(e){let{obj:l,secondObj:t,date:n}=e,s=null==l?void 0:l.flat().map(e=>{var l,t,n;return{teacherId:null===(l=e.teachers[0])||void 0===l?void 0:l.id,teacherName:null===(t=e.teachers[0])||void 0===t?void 0:t.name,login:null===(n=e.teachers[0])||void 0===n?void 0:n.shortName,room:e.room.substring(0,5),lessonName:e.lessonName,hourNumber:e.hourNumber,periodStartAndEndTime:e.periodStartAndEndTime}}).sort((e,l)=>e.room.localeCompare(l.room)),d=t.flat(),x=(0,o.useSelector)(e=>e.hourSection),[f,b]=(0,i.useState)(!1),[g,v]=(0,i.useState)(null),T=e=>{v(e),b(!0)},y=s.reduce((e,l)=>{let t=e.find(e=>e[0].room===l.room);return t?t.push(l):e.push([l]),e},[]),w=(e,l)=>{var t;let n=u()(e),i=u()(null===(t=x.find(e=>e.number===l))||void 0===t?void 0:t.start).date(n.date()).diff(n,"milliseconds"),o=u().utc(Math.abs(i)).format("mm:ss");return i<0?(0,r.jsx)(c.default,{title:n.format("HH:mm"),arrow:!0,children:(0,r.jsx)(a.Chip,{label:o,color:"warning",size:"small"})}):i>0?(0,r.jsx)(c.default,{title:n.format("HH:mm"),arrow:!0,children:(0,r.jsx)(a.Chip,{label:o,color:"success",size:"small"})}):(0,r.jsx)(a.Chip,{label:"On time",color:"default",size:"small"})};return(0,r.jsxs)(a.TableContainer,{component:a.Paper,style:{marginTop:20},children:[(0,r.jsxs)(a.Table,{children:[(0,r.jsx)(a.TableHead,{children:(0,r.jsxs)(a.TableRow,{children:[(0,r.jsx)(a.TableCell,{align:"center",sx:{borderRight:"1px solid rgba(224, 224, 224, 1)",minWidth:"85px"},children:(0,r.jsx)(a.Typography,{variant:"subtitle1",fontWeight:"bold",children:"Time"})}),x.map((e,l)=>(0,r.jsx)(a.TableCell,{align:"center",sx:{borderRight:"1px solid rgba(224, 224, 224, 1)",minWidth:"200px"},children:(0,r.jsx)(a.Typography,{variant:"subtitle2",children:e.hour})},l))]})}),(0,r.jsx)(a.TableBody,{children:y.map((e,l)=>(0,r.jsxs)(a.TableRow,{children:[(0,r.jsx)(a.TableCell,{sx:{borderRight:"1px solid rgba(224, 224, 224, 1)"},children:(0,r.jsx)(a.Typography,{variant:"body1",fontWeight:"medium",children:e[0].room})}),x.map((l,t)=>{let i=e.find(e=>e.hourNumber===l.number),o=e.filter(e=>e.hourNumber===l.number),s=d.filter(e=>e.section===(null==i?void 0:i.hourNumber)&&e.login===(null==i?void 0:i.login)).sort((e,l)=>e.time-l.time),c=d.filter(e=>e.section===(null==i?void 0:i.hourNumber)),h=u()(n.date).set({hour:u()(l.start).hours(),minute:u()(l.start).minutes()}),x=u()(m.serverTimeStorage).isAfter(h)&&(s.length>0?w(s[0].time,s[0].section):(0,r.jsx)(a.Chip,{label:"Missed lesson",color:"error",size:"small"}));return(0,r.jsx)(a.TableCell,{align:"center",sx:{borderRight:"1px solid rgba(224, 224, 224, 1)",position:"relative",height:195},children:i?(0,r.jsxs)(r.Fragment,{children:[o.length>1&&(0,r.jsx)(p,{onClick:()=>T({enterRoomTimeFilterWithoutLogin:c,lessonFilter:o}),children:o.length}),(0,r.jsx)(a.Typography,{variant:"body2",fontWeight:"medium",children:i.lessonName}),(0,r.jsx)(a.Typography,{variant:"body2",color:"textSecondary",children:i.teacherName}),(0,r.jsx)(j,{children:x})]}):"-"},t)})]},l))})]}),(0,r.jsx)(h.default,{open:f,handleClose:()=>{b(!1),v(null)},data:g})]})}let p=s.default.span(x()),j=s.default.div(f())}}]);