/*! For license information please see 8562.880adf2b.js.LICENSE.txt */
(self.webpackChunkkiut_client=self.webpackChunkkiut_client||[]).push([["8562"],{6226:function(e,t,a){"use strict";a.r(t);var r=a("58865");a("33948"),a("57658"),a("15581"),a("34514"),a("2490"),a("17727");var l=a("85893"),n=a("67294"),o=a("16393"),i=a("30381"),d=a.n(i),u=a("27233"),s=a("44118"),f=a("52861"),c=a("54520"),v=a("71893"),h=a("57024"),k=a("50533");function m(){let e=(0,r._)(["\n  width: 300px;\n  ","\n"]);return m=function(){return e},e}function g(){let e=(0,r._)(["\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  gap: 25px;\n  margin-bottom: 1rem;\n  ","\n"]);return g=function(){return e},e}function b(){let e=(0,r._)(["\n  width: 100%;\n  padding: 1rem;\n"]);return b=function(){return e},e}a("21793");let w=v.default.div(m(),(0,h.extrasmall)({width:"80%"})),S=v.default.div(g(),(0,h.extrasmall)({justifyContent:"center"})),p=v.default.div(b());t.default=()=>{let e=(0,k.useSelector)(e=>{var t;return null==e?void 0:null===(t=e.section)||void 0===t?void 0:t.section}),[t,a]=(0,n.useState)([]),[r,i]=(0,n.useState)(null),{headers:v}=(0,o.getHeaders)(),[h,m]=(0,n.useState)([]),[g,b]=(0,n.useState)(!1),[x,T]=(0,n.useState)(null),y=(e,t)=>{d().locale("ru");let a=d()(o.serverTimeStorage).year(t).isoWeek(e).startOf("isoWeek"),r=[];for(let e=0;e<6;e++)r.push(a.clone().add(e,"days").toDate());return r},[W,Y]=(0,n.useState)({date:d()(o.serverTimeStorage).format("YYYY-[W]WW"),dateFrom:d()(o.serverTimeStorage).startOf("isoWeek").toDate(),dateTo:d()(o.serverTimeStorage).endOf("isoWeek").toDate(),weekNumber:d()(o.serverTimeStorage).isoWeek(),daysOfWeek:y(d()(o.serverTimeStorage).isoWeek(),d()(o.serverTimeStorage).year())});(0,n.useEffect)(()=>{(null==e?void 0:e.id)&&u.default.get(o.BASE_URL+"/kafedra/getTeachersForSelectByKafedraId?kafedraId="+(null==e?void 0:e.id),{headers:v}).then(e=>{var t;a(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.obj)}).catch(e=>{})},[]),(0,n.useEffect)(()=>{b(!0),r&&u.default.get(o.BASE_URL+"/timeTableByWeekOfYear/getTeacherTimeTable?t="+r+"&week="+(null==W?void 0:W.weekNumber)+"&year="+d()(null==W?void 0:W.date).format("YYYY"),{headers:v}).then(e=>{var t;let a=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.obj,r=[],l={};for(let e in null==a||a.forEach(e=>{e.shows.forEach(t=>{let a=t.daysName;!l[a]&&(l[a]={teacherData:e.teacherData,shows:[]}),l[a].shows.push(t)})}),l)r.push(l[e]);m(r)}).catch(e=>{m([])}).finally(()=>{b(!1)}),r&&j(r)},[r,W]);let j=e=>{u.default.get(o.BASE_URL+"/user/getTeacherStatisticsForTimeTableByWeek?teacherId="+e+"&week="+(null==W?void 0:W.weekNumber)+"&year="+d()(null==W?void 0:W.date).format("YYYY"),{headers:v}).then(e=>{var t;T(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.obj)}).catch(e=>{T(null)})};return(0,l.jsxs)(p,{children:[(0,l.jsxs)(S,{children:[(0,l.jsx)(w,{children:(0,l.jsx)(s.default,{disablePortal:!0,id:"combo-box-demo",options:t,onChange:(e,t)=>{i(null==t?void 0:t.value)},sx:{width:300,background:"#fff"},renderInput:e=>(0,l.jsx)(f.default,{...e,label:"Teacher"})})}),(0,l.jsx)(f.default,{label:"Date of the week",type:"week",sx:{width:"200px",background:"#fff"},value:W.date,onChange:e=>{let t=e.target.value,a=d()(t).isoWeek(),r=d()(t).startOf("isoWeek").toDate(),l=d()(t).endOf("isoWeek").toDate(),n=d()(t).year();Y({date:t,dateFrom:r,dateTo:l,weekNumber:a,daysOfWeek:y(a,n)})}})]}),r&&(0,l.jsx)(c.default,{isLoading:g,obj:W,data:h,statistics:x})]})}}}]);