/*! For license information please see 8469.54fcb022.js.LICENSE.txt */
(self.webpackChunkkiut_client=self.webpackChunkkiut_client||[]).push([["8469"],{808924:function(e,l,n){"use strict";n.r(l);var t=n("258865");n("333948"),n("931672"),n("359461"),n("2490"),n("757658"),n("888449"),n("959849"),n("857640"),n("409924");var i=n("785893"),r=n("667294"),o=n("671893"),a=n("857024"),d=n("752861"),s=n("844118"),u=n("727233"),c=n("316393"),h=n("730381"),m=n.n(h),x=n("332392"),f=n("444025"),b=n("661261"),v=n("742154"),p=n("296413"),g=n("973871"),j=n("314628"),T=n("478951"),C=n("553432"),y=n("516242"),w=n("50533");function S(){let e=(0,t._)(["\n    width: 300px;\n    ","\n"]);return S=function(){return e},e}function D(){let e=(0,t._)(["\n    overflow: hidden;\n    margin: 15px 0 0;\n    padding: 10px 0;\n    display: flex;\n    flex-wrap: wrap;\n    align-items: center;\n    gap: 25px;\n    ","\n"]);return D=function(){return e},e}function k(){let e=(0,t._)(["\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 20px;\n    padding: 1rem;\n\n"]);return k=function(){return e},e}let N=o.default.div(S(),(0,a.extrasmall)({width:"80%"})),R=o.default.div(D(),(0,a.extrasmall)({justifyContent:"center"})),A=o.default.div(k());l.default=()=>{var e,l,n,t,o;let a=(0,w.useSelector)(e=>e.serverTime.time),[h,S]=(0,r.useState)(!1),[D,k]=(0,r.useState)([]),[F,W]=(0,r.useState)([]),[z,M]=(0,r.useState)([]),[_,B]=(0,r.useState)(null),[O,E]=(0,r.useState)((null==z?void 0:null===(e=z.find(e=>(null==e?void 0:e.label)===_))||void 0===e?void 0:e.minFloor)||1),{headers:H}=(0,c.getHeaders)(),[P,I]=(0,r.useState)(null),[Y,L]=(0,r.useState)(!1);(0,r.useEffect)(()=>{a&&I(m()(a))},[a]),(0,r.useEffect)(()=>{u.default.get(c.BASE_URL+"/building/getBuildingsForSelect",{headers:H}).then(e=>{var l,n,t;M(null==e?void 0:null===(l=e.data)||void 0===l?void 0:l.obj),B(null==e?void 0:null===(t=e.data)||void 0===t?void 0:null===(n=t.obj[0])||void 0===n?void 0:n.label)}).catch(e=>{})},[]),(0,r.useEffect)(()=>{S(!1),L(!1),_&&P&&U()},[_,O,P]);let U=()=>{u.default.get(c.BASE_URL+"/timeTableByWeekOfYear/getTimeTableByAllRoomAndWeek?b=".concat(null==_?void 0:_.substring(0,_.indexOf("-")),"-").concat(O,"&week=").concat(P.isoWeek(),"&weekday=").concat(P.day(),"&year=").concat(P.year(),"&t=true"),{headers:H}).then(e=>{var l;k(e.data.obj),W(null==e?void 0:null===(l=e.data)||void 0===l?void 0:l.secondObj),S(!0),L(!1)}).catch(e=>{L(!0)})};return P&&(0,i.jsxs)(A,{children:[z&&(null==z?void 0:z.length)>0&&(0,i.jsxs)(R,{children:[(0,i.jsx)(N,{children:(0,i.jsx)(s.default,{disablePortal:!0,id:"combo-box-demo",options:z,defaultValue:z[0],onChange:(e,l)=>{B(null==l?void 0:l.label)},renderInput:e=>(0,i.jsx)(d.default,{...e,label:"Buildings"})})}),(0,i.jsx)(N,{children:(0,i.jsxs)(v.default,{fullWidth:!0,children:[(0,i.jsx)(x.default,{id:"demo-simple-select-label",children:"Floor"}),(0,i.jsx)(f.default,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:O,label:"Floor",onChange:e=>{E(e.target.value)},children:null===(n=function(e,l){let n=[];for(;e<=l;e++)n.push(e);return n}(null==z?void 0:null===(t=z.find(e=>(null==e?void 0:e.label)===_))||void 0===t?void 0:t.minFloor,null==z?void 0:null===(o=z.find(e=>(null==e?void 0:e.label)===_))||void 0===o?void 0:o.maxFloor))||void 0===n?void 0:null===(l=n.filter(e=>0!==e))||void 0===l?void 0:l.map(e=>(0,i.jsx)(b.default,{value:e,children:e}))})]})}),(0,i.jsx)(g.LocalizationProvider,{dateAdapter:p.AdapterMoment,children:(0,i.jsx)(j.DesktopDatePicker,{label:"Day",inputFormat:"DD/MM/YYYY",value:P,onChange:e=>{I(m()(e))},renderInput:e=>(0,i.jsx)(d.default,{...e})})})]}),(0,i.jsx)("div",{style:{width:"100%",overflowX:"scroll"},children:h?(0,i.jsx)(y.default,{obj:D,secondObj:F,date:P,serverTime:a}):Y?(0,i.jsx)(T.default,{w:"200",h:"180"}):(0,i.jsx)(C.default,{})})]})}},526457:function(e,l,n){"use strict";n.r(l);var t=n("258865");n("931672"),n("359461"),n("2490"),n("888449"),n("959849"),n("857640"),n("409924");var i=n("785893"),r=n("667294"),o=n("807104"),a=n("671893"),d=n("326178"),s=n("478951"),u=n("730381"),c=n.n(u),h=n("50533"),m=n("405434"),x=n("651649");function f(){let e=(0,t._)(["\n    color: ",";\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 5px;\n"]);return f=function(){return e},e}let b=(0,r.forwardRef)(function(e,l){return(0,i.jsx)(o.Slide,{direction:"up",ref:l,...e})}),v=(0,d.createTheme)({components:{MuiTableCell:{styleOverrides:{root:{justifyContent:"center",textAlign:"center",border:"1px solid #ccc",padding:"10px"}}}}}),p=a.default.span(f(),e=>e.color?"green":"red");l.default=(0,r.memo)(e=>{var l,n,t;let{open:r,handleClose:a,data:u}=e,f=(0,h.useSelector)(e=>e.hourSection),g=e=>{var l,n,t;let r=null==e?void 0:e.login,o=null==e?void 0:e.hourNumber,a=null===(l=f.find(e=>e.number===o))||void 0===l?void 0:l.start,d=null==u?void 0:null===(n=u.enterRoomTimeFilterWithoutLogin)||void 0===n?void 0:n.filter(e=>(null==e?void 0:e.section)===o&&(null==e?void 0:e.login)===r).sort((e,l)=>new Date(e.time)-new Date(l.time));if(!d||0===d.length)return(0,i.jsx)(x.IoMdCloseCircle,{size:20,color:"red"});let s=null===(t=d[0])||void 0===t?void 0:t.time,h=new Date(a).setDate(new Date(s).getDate())>=s;return(0,i.jsxs)(p,{color:h,children:[h?(0,i.jsx)(m.MdOutlineAddCircleOutline,{size:16}):(0,i.jsx)(m.MdRemoveCircleOutline,{size:16}),(0,i.jsx)("p",{children:c()(Math.abs(new Date(a).setDate(new Date(s).getDate())-s)).format("mm:ss")})]})};return r&&(0,i.jsxs)(o.Dialog,{open:r,maxWidth:"md",TransitionComponent:b,keepMounted:!0,onClose:a,"aria-labelledby":"selected-lesson-dialog-title",fullWidth:!0,children:[(0,i.jsxs)(o.DialogTitle,{id:"selected-lesson-dialog-title",children:[null==u?void 0:null===(l=u.lessonFilter[0])||void 0===l?void 0:l.room," ",null==u?void 0:null===(n=u.lessonFilter[0])||void 0===n?void 0:n.periodStartAndEndTime]}),(0,i.jsx)(o.DialogContent,{sx:{padding:"0 5px"},children:(0,i.jsx)(d.ThemeProvider,{theme:v,children:(0,i.jsx)(o.TableContainer,{component:o.Paper,children:(0,i.jsxs)(o.Table,{sx:{minWidth:450},"aria-label":"selected-hour-lessons",children:[(0,i.jsx)(o.TableHead,{children:(0,i.jsxs)(o.TableRow,{children:[(0,i.jsx)(o.TableCell,{children:(0,i.jsx)("b",{children:"Teacher"})}),(0,i.jsx)(o.TableCell,{children:(0,i.jsx)("b",{children:"Subjects"})}),(0,i.jsx)(o.TableCell,{children:(0,i.jsx)("b",{children:"Attendance"})})]})}),(0,i.jsx)(o.TableBody,{children:(null==u?void 0:null===(t=u.lessonFilter)||void 0===t?void 0:t.length)?u.lessonFilter.map((e,l)=>(0,i.jsxs)(o.TableRow,{children:[(0,i.jsx)(o.TableCell,{children:null==e?void 0:e.teacherName}),(0,i.jsx)(o.TableCell,{children:null==e?void 0:e.lessonName}),(0,i.jsx)(o.TableCell,{children:g(e)})]},l)):(0,i.jsx)(o.TableRow,{children:(0,i.jsx)(o.TableCell,{colSpan:3,children:(0,i.jsx)(s.default,{w:200,h:180})})})})]})})})}),(0,i.jsx)(o.DialogActions,{children:(0,i.jsx)(o.Button,{size:"small",variant:"outlined",onClick:a,children:"Close"})})]})})},516242:function(e,l,n){"use strict";n.r(l),n.d(l,{default:function(){return f}});var t=n("258865");n("133792"),n("857640"),n("409924"),n("333948"),n("25387"),n("772608"),n("2490"),n("931672"),n("359461"),n("757658"),n("888449"),n("959849");var i=n("785893"),r=n("667294"),o=n("50533"),a=n("807104"),d=n("671893"),s=n("730381"),u=n.n(s),c=n("503506"),h=n("526457");function m(){let e=(0,t._)(["\n    cursor: pointer;\n    color: #fff;\n    width: 23px;\n    height: 23px;\n    position: absolute;\n    left: 10px;\n    bottom: 10px;\n    font-size: 12px;\n    border-radius: 50%;\n    background-color: rgba(0, 0, 255, 0.75);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    text-align: center;\n    line-height: 1;\n"]);return m=function(){return e},e}function x(){let e=(0,t._)(["\nposition: absolute;\n    bottom: 10px;\n    right: 10px;\n"]);return x=function(){return e},e}function f(e){let{obj:l,secondObj:n,date:t,serverTime:d=new Date().getTime()}=e,s=null==l?void 0:l.flat().map(e=>{var l,n,t;return{teacherId:null===(l=e.teachers[0])||void 0===l?void 0:l.id,teacherName:null===(n=e.teachers[0])||void 0===n?void 0:n.name,login:null===(t=e.teachers[0])||void 0===t?void 0:t.shortName,room:e.room.substring(0,6),lessonName:e.lessonName,hourNumber:e.hourNumber,periodStartAndEndTime:e.periodStartAndEndTime}}).sort((e,l)=>e.room.localeCompare(l.room));n.flat();let m=(0,o.useSelector)(e=>e.hourSection),[x,f]=(0,r.useState)(!1),[p,g]=(0,r.useState)(null),j=e=>{g(e),f(!0)},T=s.reduce((e,l)=>{let n=e.find(e=>e[0].room.substring(0,6)===l.room.substring(0,6));return n?n.push(l):e.push([l]),e},[]),C=(e,l)=>{var n;let t=u()(e),r=u()(null===(n=m.find(e=>e.number===l))||void 0===n?void 0:n.start).date(t.date()).diff(t,"milliseconds"),o=u().utc(Math.abs(r)).format("mm:ss");return r<0?(0,i.jsx)(c.default,{title:t.format("HH:mm"),arrow:!0,children:(0,i.jsx)(a.Chip,{label:o,color:"warning",size:"small"})}):r>0?(0,i.jsx)(c.default,{title:t.format("HH:mm"),arrow:!0,children:(0,i.jsx)(a.Chip,{label:o,color:"success",size:"small"})}):(0,i.jsx)(a.Chip,{label:"On time",color:"default",size:"small"})};return(0,i.jsxs)(a.TableContainer,{component:a.Paper,style:{marginTop:20},children:[(0,i.jsxs)(a.Table,{children:[(0,i.jsx)(a.TableHead,{children:(0,i.jsxs)(a.TableRow,{children:[(0,i.jsx)(a.TableCell,{align:"center",sx:{borderRight:"1px solid rgba(224, 224, 224, 1)",minWidth:"85px"},children:(0,i.jsx)(a.Typography,{variant:"subtitle1",fontWeight:"bold",children:"Time"})}),m.map((e,l)=>(0,i.jsx)(a.TableCell,{align:"center",sx:{borderRight:"1px solid rgba(224, 224, 224, 1)",minWidth:"200px"},children:(0,i.jsx)(a.Typography,{variant:"subtitle2",children:e.hour})},l))]})}),(0,i.jsx)(a.TableBody,{children:T.map((e,l)=>(0,i.jsxs)(a.TableRow,{children:[(0,i.jsx)(a.TableCell,{sx:{borderRight:"1px solid rgba(224, 224, 224, 1)"},children:(0,i.jsx)(a.Typography,{variant:"body1",fontWeight:"medium",sx:{fontSize:"14px"},children:e[0].room})}),m.map((l,r)=>{let o=e.find(e=>e.hourNumber===l.number),s=e.filter(e=>e.hourNumber===l.number),c=n.flat().filter(l=>l.room.substring(0,6).trim()===e[0].room.substring(0,6).trim()&&l.section===(null==o?void 0:o.hourNumber)&&l.login===(null==o?void 0:o.login)).sort((e,l)=>e.time-l.time),h=n.flat().filter(l=>l.room.substring(0,6).trim()===e[0].room.substring(0,6).trim()&&l.section===(null==o?void 0:o.hourNumber)),m=u()(t).set({hour:u()(l.start).hours(),minute:u()(l.start).minutes()}),x=u()(d).isAfter(m)&&(c.length>0?C(c[0].time,c[0].section):(0,i.jsx)(a.Chip,{label:"Missed lesson",color:"error",size:"small"}));return(0,i.jsx)(a.TableCell,{align:"center",sx:{borderRight:"1px solid rgba(224, 224, 224, 1)",position:"relative",height:195},children:o?(0,i.jsxs)(i.Fragment,{children:[s.length>1&&(0,i.jsx)(b,{onClick:()=>j({enterRoomTimeFilterWithoutLogin:h,lessonFilter:s}),children:s.length}),(0,i.jsx)(a.Typography,{variant:"body2",fontWeight:"medium",children:o.lessonName}),(0,i.jsx)(a.Typography,{variant:"body2",color:"textSecondary",children:o.teacherName}),(0,i.jsx)(v,{children:x})]}):"-"},r)})]},l))})]}),(0,i.jsx)(h.default,{open:x,handleClose:()=>{f(!1),g(null)},data:p})]})}let b=d.default.span(m()),v=d.default.div(x())}}]);