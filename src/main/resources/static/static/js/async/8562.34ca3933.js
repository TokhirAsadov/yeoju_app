/*! For license information please see 8562.34ca3933.js.LICENSE.txt */
(self.webpackChunkkiut_client=self.webpackChunkkiut_client||[]).push([["8562"],{6226:function(e,t,a){"use strict";a.r(t);var l=a("58865");a("33948"),a("57658"),a("15581"),a("34514"),a("2490"),a("17727");var n=a("85893"),r=a("67294"),o=a("16393"),d=a("30381"),u=a.n(d),i=a("27233"),s=a("44118"),f=a("52861"),c=a("54520"),h=a("71893"),v=a("57024"),k=a("50533");function b(){let e=(0,l._)(["\n  width: 300px;\n  ","\n"]);return b=function(){return e},e}function m(){let e=(0,l._)(["\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  gap: 25px;\n  margin-bottom: 1rem;\n  ","\n"]);return m=function(){return e},e}function w(){let e=(0,l._)(["\n  width: 100%;\n  padding: 1rem;\n"]);return w=function(){return e},e}a("21793");let g=h.default.div(b(),(0,v.extrasmall)({width:"80%"})),p=h.default.div(m(),(0,v.extrasmall)({justifyContent:"center"})),x=h.default.div(w());t.default=()=>{let e=(0,k.useSelector)(e=>{var t;return null==e?void 0:null===(t=e.section)||void 0===t?void 0:t.section}),[t,a]=(0,r.useState)([]),[l,d]=(0,r.useState)(null),{headers:h}=(0,o.getHeaders)(),[v,b]=(0,r.useState)([]),[m,w]=(0,r.useState)(!1),[y,W]=(0,r.useState)(null),Y=(e,t)=>{u().locale("ru");let a=u()().year(t).isoWeek(e).startOf("isoWeek"),l=[];for(let e=0;e<6;e++)l.push(a.clone().add(e,"days").toDate());return l},[j,S]=(0,r.useState)({date:u()().format("YYYY-[W]WW"),dateFrom:u()().startOf("isoWeek").toDate(),dateTo:u()().endOf("isoWeek").toDate(),weekNumber:u()().isoWeek(),daysOfWeek:Y(u()().isoWeek(),u()().year())});(0,r.useEffect)(()=>{(null==e?void 0:e.id)&&i.default.get(o.BASE_URL+"/kafedra/getTeachersForSelectByKafedraId?kafedraId="+(null==e?void 0:e.id),{headers:h}).then(e=>{var t;a(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.obj)}).catch(e=>{})},[]),(0,r.useEffect)(()=>{w(!0),l&&i.default.get(o.BASE_URL+"/timeTableByWeekOfYear/getTeacherTimeTable?t="+l+"&week="+(null==j?void 0:j.weekNumber)+"&year="+u()(null==j?void 0:j.date).format("YYYY"),{headers:h}).then(e=>{var t;let a=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.obj,l=[],n={};for(let e in null==a||a.forEach(e=>{e.shows.forEach(t=>{let a=t.daysName;!n[a]&&(n[a]={teacherData:e.teacherData,shows:[]}),n[a].shows.push(t)})}),n)l.push(n[e]);b(l)}).catch(e=>{b([])}).finally(()=>{w(!1)}),l&&T(l)},[l,j]);let T=e=>{i.default.get(o.BASE_URL+"/user/getTeacherStatisticsForTimeTableByWeek?teacherId="+e+"&week="+(null==j?void 0:j.weekNumber)+"&year="+u()(null==j?void 0:j.date).format("YYYY"),{headers:h}).then(e=>{var t;W(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.obj)}).catch(e=>{W(null)})};return(0,n.jsxs)(x,{children:[(0,n.jsxs)(p,{children:[(0,n.jsx)(g,{children:(0,n.jsx)(s.default,{disablePortal:!0,id:"combo-box-demo",options:t,onChange:(e,t)=>{d(null==t?void 0:t.value)},sx:{width:300,background:"#fff"},renderInput:e=>(0,n.jsx)(f.default,{...e,label:"Teacher"})})}),(0,n.jsx)(f.default,{label:"Date of the week",type:"week",sx:{width:"200px",background:"#fff"},value:j.date,onChange:e=>{let t=e.target.value,a=u()(t).isoWeek(),l=u()(t).startOf("isoWeek").toDate(),n=u()(t).endOf("isoWeek").toDate(),r=u()(t).year();S({date:t,dateFrom:l,dateTo:n,weekNumber:a,daysOfWeek:Y(a,r)})}})]}),l&&(0,n.jsx)(c.default,{isLoading:m,obj:j,data:v,statistics:y})]})}}}]);