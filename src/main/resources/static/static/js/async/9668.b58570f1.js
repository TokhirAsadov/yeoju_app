/*! For license information please see 9668.b58570f1.js.LICENSE.txt */
(self.webpackChunkkiut_client=self.webpackChunkkiut_client||[]).push([["9668"],{26571:function(e,l,n){"use strict";n.r(l);var t=n("58865");n("33948"),n("17727"),n("57640"),n("9924");var r=n("85893"),i=n("67294"),o=n("71893"),a=n("57024"),s=n("44118"),d=n("52861"),u=n("27233"),c=n("16393"),h=n("30381"),m=n.n(h),x=n("96413"),f=n("73871"),p=n("14628"),b=n("53432"),j=n("78951"),v=n("10456"),g=n("50533");function T(){let e=(0,t._)(["\n    width: 300px;\n    ","\n"]);return T=function(){return e},e}function y(){let e=(0,t._)(["\n    margin: 15px 0 0;\n    padding: 10px 0;\n    display: flex;\n    flex-wrap: wrap;\n    align-items: center;\n    gap: 25px;\n    justify-content: start;\n    ","\n"]);return y=function(){return e},e}function C(){let e=(0,t._)(["\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 20px;\n    padding: 1rem;\n"]);return C=function(){return e},e}let w=o.default.div(T(),(0,a.extrasmall)({width:"80%"})),S=o.default.div(y(),(0,a.extrasmall)({justifyContent:"center"})),D=o.default.div(C());l.default=()=>{let e=(0,g.useSelector)(e=>e.serverTime.time),[l,n]=(0,i.useState)([]),[t,o]=(0,i.useState)(!1),[a,h]=(0,i.useState)([]),[T,y]=(0,i.useState)([]),[C,k]=(0,i.useState)(null),[R,N]=(0,i.useState)(!1),[A,M]=(0,i.useState)(null);(0,i.useEffect)(()=>{e&&M(m()(e))},[e]);let{headers:W}=(0,c.getHeaders)();(0,i.useEffect)(()=>{u.default.get("".concat(c.BASE_URL,"/room/getRoomsForSelect"),{headers:W}).then(e=>{var l;return n((null===(l=e.data)||void 0===l?void 0:l.obj)||[])}).catch(()=>{})},[]);let z=()=>{C&&A&&(N(!0),u.default.get("".concat(c.BASE_URL,"/timeTableByWeekOfYear/getTimeTableByRoom"),{params:{r:C,week:A.isoWeek(),weekday:A.day(),year:A.year()},headers:W}).then(e=>{var l,n;h((null===(l=e.data)||void 0===l?void 0:l.obj)||[]),y((null===(n=e.data)||void 0===n?void 0:n.secondObj)||[]),o(!1)}).catch(()=>o(!0)).finally(()=>N(!1)))};return(0,i.useEffect)(()=>{z()},[C,A]),A&&(0,r.jsxs)(D,{children:[(0,r.jsxs)(S,{children:[(0,r.jsx)(w,{children:(0,r.jsx)(s.default,{disablePortal:!0,id:"combo-box-demo",options:l.map(e=>({label:e.label})),onChange:(e,l)=>k((null==l?void 0:l.label)||null),sx:{width:300},renderInput:e=>(0,r.jsx)(d.default,{...e,label:"Auditory"})})}),(0,r.jsx)(w,{children:(0,r.jsx)(f.LocalizationProvider,{dateAdapter:x.AdapterMoment,children:(0,r.jsx)(p.DesktopDatePicker,{label:"Day",inputFormat:"DD/MM/YYYY",value:A,onChange:e=>M(m()(e)),renderInput:e=>(0,r.jsx)(d.default,{...e,sx:{width:300}})})})})]}),R?(0,r.jsx)(b.default,{}):t?(0,r.jsx)(j.default,{w:"200",h:"180"}):(0,r.jsx)(v.default,{obj:a,secondObj:T,date:A})]})}},26457:function(e,l,n){"use strict";n.r(l);var t=n("58865");n("31672"),n("59461"),n("2490"),n("88449"),n("19894"),n("57640"),n("9924");var r=n("85893"),i=n("67294"),o=n("7104"),a=n("71893"),s=n("26178"),d=n("78951"),u=n("30381"),c=n.n(u),h=n("50533"),m=n("5434"),x=n("51649");function f(){let e=(0,t._)(["\n    color: ",";\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 5px;\n"]);return f=function(){return e},e}let p=(0,i.forwardRef)(function(e,l){return(0,r.jsx)(o.Slide,{direction:"up",ref:l,...e})}),b=(0,s.createTheme)({components:{MuiTableCell:{styleOverrides:{root:{justifyContent:"center",textAlign:"center",border:"1px solid #ccc",padding:"10px"}}}}}),j=a.default.span(f(),e=>e.color?"green":"red");l.default=(0,i.memo)(e=>{var l,n,t;let{open:i,handleClose:a,data:u}=e,f=(0,h.useSelector)(e=>e.hourSection),v=e=>{var l,n,t;let i=null==e?void 0:e.login,o=null==e?void 0:e.hourNumber,a=null===(l=f.find(e=>e.number===o))||void 0===l?void 0:l.start,s=null==u?void 0:null===(n=u.enterRoomTimeFilterWithoutLogin)||void 0===n?void 0:n.filter(e=>(null==e?void 0:e.section)===o&&(null==e?void 0:e.login)===i).sort((e,l)=>new Date(e.time)-new Date(l.time));if(!s||0===s.length)return(0,r.jsx)(x.IoMdCloseCircle,{size:20,color:"red"});let d=null===(t=s[0])||void 0===t?void 0:t.time,h=new Date(a).setDate(new Date(d).getDate())>=d;return(0,r.jsxs)(j,{color:h,children:[h?(0,r.jsx)(m.MdOutlineAddCircleOutline,{size:16}):(0,r.jsx)(m.MdRemoveCircleOutline,{size:16}),(0,r.jsx)("p",{children:c()(Math.abs(new Date(a).setDate(new Date(d).getDate())-d)).format("mm:ss")})]})};return i&&(0,r.jsxs)(o.Dialog,{open:i,maxWidth:"md",TransitionComponent:p,keepMounted:!0,onClose:a,"aria-labelledby":"selected-lesson-dialog-title",fullWidth:!0,children:[(0,r.jsxs)(o.DialogTitle,{id:"selected-lesson-dialog-title",children:[null==u?void 0:null===(l=u.lessonFilter[0])||void 0===l?void 0:l.room," ",null==u?void 0:null===(n=u.lessonFilter[0])||void 0===n?void 0:n.periodStartAndEndTime]}),(0,r.jsx)(o.DialogContent,{sx:{padding:"0 5px"},children:(0,r.jsx)(s.ThemeProvider,{theme:b,children:(0,r.jsx)(o.TableContainer,{component:o.Paper,children:(0,r.jsxs)(o.Table,{sx:{minWidth:450},"aria-label":"selected-hour-lessons",children:[(0,r.jsx)(o.TableHead,{children:(0,r.jsxs)(o.TableRow,{children:[(0,r.jsx)(o.TableCell,{children:(0,r.jsx)("b",{children:"Teacher"})}),(0,r.jsx)(o.TableCell,{children:(0,r.jsx)("b",{children:"Subjects"})}),(0,r.jsx)(o.TableCell,{children:(0,r.jsx)("b",{children:"Attendance"})})]})}),(0,r.jsx)(o.TableBody,{children:(null==u?void 0:null===(t=u.lessonFilter)||void 0===t?void 0:t.length)?u.lessonFilter.map((e,l)=>(0,r.jsxs)(o.TableRow,{children:[(0,r.jsx)(o.TableCell,{children:null==e?void 0:e.teacherName}),(0,r.jsx)(o.TableCell,{children:null==e?void 0:e.lessonName}),(0,r.jsx)(o.TableCell,{children:v(e)})]},l)):(0,r.jsx)(o.TableRow,{children:(0,r.jsx)(o.TableCell,{colSpan:3,children:(0,r.jsx)(d.default,{w:200,h:180})})})})]})})})}),(0,r.jsx)(o.DialogActions,{children:(0,r.jsx)(o.Button,{size:"small",variant:"outlined",onClick:a,children:"Close"})})]})})},10456:function(e,l,n){"use strict";n.r(l),n.d(l,{default:function(){return p}});var t=n("58865");n("33792"),n("57640"),n("9924"),n("33948"),n("25387"),n("72608"),n("2490"),n("31672"),n("59461"),n("57658"),n("88449"),n("19894");var r=n("85893"),i=n("67294"),o=n("50533"),a=n("7104"),s=n("71893"),d=n("30381"),u=n.n(d),c=n("3506"),h=n("26457"),m=n("16393");function x(){let e=(0,t._)(["\n    cursor: pointer;\n    color: #fff;\n    width: 23px;\n    height: 23px;\n    position: absolute;\n    left: 10px;\n    bottom: 10px;\n    font-size: 12px;\n    border-radius: 50%;\n    background-color: rgba(0, 0, 255, 0.75);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    text-align: center;\n    line-height: 1;\n"]);return x=function(){return e},e}function f(){let e=(0,t._)(["\nposition: absolute;\n    bottom: 10px;\n    right: 10px;\n"]);return f=function(){return e},e}function p(e){let{obj:l,secondObj:n,date:t}=e,s=null==l?void 0:l.flat().map(e=>{var l,n,t;return{teacherId:null===(l=e.teachers[0])||void 0===l?void 0:l.id,teacherName:null===(n=e.teachers[0])||void 0===n?void 0:n.name,login:null===(t=e.teachers[0])||void 0===t?void 0:t.shortName,room:e.room.substring(0,5),lessonName:e.lessonName,hourNumber:e.hourNumber,periodStartAndEndTime:e.periodStartAndEndTime}}).sort((e,l)=>e.room.localeCompare(l.room)),d=n.flat(),x=(0,o.useSelector)(e=>e.hourSection),[f,p]=(0,i.useState)(!1),[v,g]=(0,i.useState)(null),T=e=>{g(e),p(!0)},y=s.reduce((e,l)=>{let n=e.find(e=>e[0].room===l.room);return n?n.push(l):e.push([l]),e},[]),C=(e,l)=>{var n;let t=u()(e),i=u()(null===(n=x.find(e=>e.number===l))||void 0===n?void 0:n.start).date(t.date()).diff(t,"milliseconds"),o=u().utc(Math.abs(i)).format("mm:ss");return i<0?(0,r.jsx)(c.default,{title:t.format("HH:mm"),arrow:!0,children:(0,r.jsx)(a.Chip,{label:o,color:"warning",size:"small"})}):i>0?(0,r.jsx)(c.default,{title:t.format("HH:mm"),arrow:!0,children:(0,r.jsx)(a.Chip,{label:o,color:"success",size:"small"})}):(0,r.jsx)(a.Chip,{label:"On time",color:"default",size:"small"})};return(0,r.jsxs)(a.TableContainer,{component:a.Paper,style:{marginTop:20},children:[(0,r.jsxs)(a.Table,{children:[(0,r.jsx)(a.TableHead,{children:(0,r.jsxs)(a.TableRow,{children:[(0,r.jsx)(a.TableCell,{align:"center",sx:{borderRight:"1px solid rgba(224, 224, 224, 1)",minWidth:"85px"},children:(0,r.jsx)(a.Typography,{variant:"subtitle1",fontWeight:"bold",children:"Time"})}),x.map((e,l)=>(0,r.jsx)(a.TableCell,{align:"center",sx:{borderRight:"1px solid rgba(224, 224, 224, 1)",minWidth:"200px"},children:(0,r.jsx)(a.Typography,{variant:"subtitle2",children:e.hour})},l))]})}),(0,r.jsx)(a.TableBody,{children:y.map((e,l)=>(0,r.jsxs)(a.TableRow,{children:[(0,r.jsx)(a.TableCell,{sx:{borderRight:"1px solid rgba(224, 224, 224, 1)"},children:(0,r.jsx)(a.Typography,{variant:"body1",fontWeight:"medium",children:e[0].room})}),x.map((l,n)=>{let i=e.find(e=>e.hourNumber===l.number),o=e.filter(e=>e.hourNumber===l.number),s=d.filter(e=>e.section===(null==i?void 0:i.hourNumber)&&e.login===(null==i?void 0:i.login)).sort((e,l)=>e.time-l.time),c=d.filter(e=>e.section===(null==i?void 0:i.hourNumber)),h=u()(t).set({hour:u()(l.start).hours(),minute:u()(l.start).minutes()}),x=u()(m.serverTimeStorage).isAfter(h)&&(s.length>0?C(s[0].time,s[0].section):(0,r.jsx)(a.Chip,{label:"Missed lesson",color:"error",size:"small"}));return(0,r.jsx)(a.TableCell,{align:"center",sx:{borderRight:"1px solid rgba(224, 224, 224, 1)",position:"relative",height:195},children:i?(0,r.jsxs)(r.Fragment,{children:[o.length>1&&(0,r.jsx)(b,{onClick:()=>T({enterRoomTimeFilterWithoutLogin:c,lessonFilter:o}),children:o.length}),(0,r.jsx)(a.Typography,{variant:"body2",fontWeight:"medium",children:i.lessonName}),(0,r.jsx)(a.Typography,{variant:"body2",color:"textSecondary",children:i.teacherName}),(0,r.jsx)(j,{children:x})]}):"-"},n)})]},l))})]}),(0,r.jsx)(h.default,{open:f,handleClose:()=>{p(!1),g(null)},data:v})]})}let b=s.default.span(x()),j=s.default.div(f())}}]);