/*! For license information please see 8775.1d88c46c.js.LICENSE.txt */
(self.webpackChunkkiut_client=self.webpackChunkkiut_client||[]).push([["8775"],{77918:function(e,l,t){"use strict";t.r(l);var o=t("258865");t("333948"),t("25387"),t("772608"),t("2490"),t("215581"),t("634514"),t("757658");var i=t("785893"),n=t("667294"),r=t("671893"),a=t("316393"),d=t("50533"),s=t("730381"),u=t.n(s);t("321793");var c=t("783833"),v=t("752861"),h=t("193065");function f(){let e=(0,o._)(["\n    color: ",";\n    margin-bottom: 20px;\n"]);return f=function(){return e},e}function m(){let e=(0,o._)(["\n    width: 100%;\n    padding: 1rem !important;\n"]);return m=function(){return e},e}let x=r.default.h3(f(),a.mainColor),p=r.default.div(m());l.default=()=>{let{headers:e}=(0,a.getHeaders)();(0,d.useSelector)(e=>e.serverTime.time);let l=(0,d.useSelector)(e=>{var l;return null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.user}),[t,o]=(0,n.useState)([]),[r,s]=(0,n.useState)(null),[f,m]=(0,n.useState)(!1),[b,g]=(0,n.useState)(u()(new Date)),j=async()=>{try{var t,i,n;m(!0);let[r,a]=await Promise.all([h.default.get("/timeTableByWeekOfYear/getTeacherTimeTable?t=".concat(null==l?void 0:l.id,"&week=").concat(null==b?void 0:b.isoWeek(),"&year=").concat(null==b?void 0:b.year()),{headers:e}),h.default.get("/user/getTeacherStatisticsForTimeTableByWeek?teacherId=".concat(null==l?void 0:l.id,"&week=").concat(null==b?void 0:b.isoWeek(),"&year=").concat(null==b?void 0:b.year()),{headers:e})]),d=(null==r?void 0:null===(t=r.data)||void 0===t?void 0:t.obj)||[];localStorage.setItem("serverTime",null==r?void 0:null===(i=r.data)||void 0===i?void 0:i.time);let u=d.reduce((e,l)=>(l.shows.forEach(t=>{let o=t.daysName;!e[o]&&(e[o]={teacherData:l.teacherData,shows:[]}),e[o].shows.push(t)}),e),{});o(Object.values(u)),s((null==a?void 0:null===(n=a.data)||void 0===n?void 0:n.obj)||[])}catch(e){s([])}finally{m(!1)}};return(0,n.useEffect)(()=>{u().locale("ru"),b&&j()},[b]),(0,i.jsxs)(p,{children:[(0,i.jsx)(x,{children:"Schedule of lessons"}),(0,i.jsx)(v.default,{label:"Date of the week",type:"week",sx:{width:"200px"},value:b?b.format("YYYY-[W]WW"):"",onChange:e=>g(u()(e.target.value)),size:"small"}),b&&(0,i.jsx)(c.default,{isLoading:f,dateInput:b,data:t,statistics:r})]})}},783833:function(e,l,t){"use strict";t.r(l);var o=t("258865");t("857640"),t("409924"),t("931672"),t("359461"),t("2490"),t("888449"),t("959849");var i=t("785893");t("667294");var n=t("671893"),r=t("807104"),a=t("316393"),d=t("730381"),s=t.n(d),u=t("489589"),c=t("478951"),v=t("50533"),h=t("455693");function f(){let e=(0,o._)(["\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n    gap: 5px;\n"]);return f=function(){return e},e}function m(){let e=(0,o._)(["\n    width: 100%;\n    overflow: scroll;\n"]);return m=function(){return e},e}let x=n.default.span(f()),p=n.default.div(m());l.default=e=>{var l;let{data:t,statistics:o,dateInput:n,isLoading:d}=e,f=(0,v.useSelector)(e=>e.hourSection),m=null===(l=(e=>{let l=e.startOf("isoWeek");return Array.from({length:6},(e,t)=>l.clone().add(t,"days").toDate())})(n))||void 0===l?void 0:l.map((e,l)=>{let t=s()(e).format("dd"),o=s()(e).format("dddd"),i=t.charAt(0).toUpperCase()+t.slice(1).toLowerCase();return{day:l+1,name:i,name2:o.charAt(0).toUpperCase()+o.slice(1).toLowerCase(),date:s()(e)}}),b=(e,l,t,o)=>{let n=s()(o).set({hour:s()(t).hours(),minute:s()(t).minutes()});if(s()(a.serverTimeStorage).isAfter(n)){var d;if(!e||!l)return(0,i.jsx)(r.Chip,{label:(0,i.jsx)("p",{style:{fontSize:11},children:"Missed"}),color:"error",size:"small"});let t=s()(e),o=s()(null===(d=f.find(e=>e.number===l))||void 0===d?void 0:d.start).date(t.date()).diff(t,"milliseconds"),n=s().utc(Math.abs(o)).format("mm:ss");return o<0?(0,i.jsx)(r.Tooltip,{title:t.format("HH:mm"),arrow:!0,placement:"top",children:(0,i.jsx)(r.Chip,{label:(0,i.jsx)("p",{style:{fontSize:11},children:n}),color:"warning",size:"small"})}):o>0?(0,i.jsx)(r.Tooltip,{title:t.format("HH:mm"),arrow:!0,placement:"top",children:(0,i.jsx)(r.Chip,{label:(0,i.jsx)("p",{style:{fontSize:11},children:n}),color:"success",size:"small"})}):(0,i.jsx)(r.Chip,{label:"On time",color:"default",size:"small"})}};return(0,i.jsx)(p,{children:d?(0,i.jsx)(r.Stack,{spacing:1,children:(0,i.jsx)(r.Skeleton,{variant:"rectangular",style:{margin:"15px auto"},width:"100%",height:500})}):(null==t?void 0:t.length)===0?(0,i.jsx)(r.Card,{children:(0,i.jsxs)(r.CardContent,{children:[(0,i.jsx)(u.default,{textAlign:"center",fontSize:20,fontWeight:"bold",color:"error",children:"No class schedule available !"}),(0,i.jsx)(c.default,{w:200,h:180})]})}):(0,i.jsx)(r.TableContainer,{component:r.Paper,style:{marginTop:20,overflow:"auto"},children:(0,i.jsxs)(r.Table,{sx:{minWidth:2200},children:[(0,i.jsx)(r.TableHead,{children:(0,i.jsxs)(r.TableRow,{children:[(0,i.jsx)(r.TableCell,{sx:{position:"sticky",left:0,backgroundColor:"#fff",zIndex:1,borderRight:"1px solid rgba(224, 224, 224, 1)"},align:"center",children:(0,i.jsx)("strong",{children:"TIME"})}),null==f?void 0:f.map((e,l)=>(0,i.jsx)(r.TableCell,{sx:{width:200,borderRight:"1px solid rgba(224, 224, 224, 1)"},align:"center",children:(0,i.jsx)("strong",{children:null==e?void 0:e.hour})},l))]})}),(0,i.jsx)(r.TableBody,{children:null==m?void 0:m.map((e,l)=>{let n=null==t?void 0:t.find(l=>{var t,o;return(null==l?void 0:null===(t=l.shows[0])||void 0===t?void 0:t.daysName)===(null==e?void 0:e.name)||(null==l?void 0:null===(o=l.shows[0])||void 0===o?void 0:o.daysName)===(null==e?void 0:e.name2)}),a=null;return o&&(a=o[null==e?void 0:e.day]),(0,i.jsxs)(r.TableRow,{children:[(0,i.jsx)(r.TableCell,{sx:{position:"sticky",left:0,backgroundColor:"#fff",zIndex:1,height:120,borderRight:"1px solid rgba(224, 224, 224, 1)"},align:"center",children:(0,i.jsx)(u.default,{fontSize:12,children:(0,i.jsxs)("b",{children:[null==e?void 0:e.name,(0,i.jsx)("br",{})," ",null==e?void 0:e.date.format("DD.MM.YYYY")]})})}),null==f?void 0:f.map((l,t)=>{var o,d,s,c,v,f;let m=null==n?void 0:null===(o=n.shows)||void 0===o?void 0:o.find(e=>(null==e?void 0:e.hourNumber)===(null==l?void 0:l.number)),p=(null==a?void 0:a.find(e=>{var l;return null==e?void 0:null===(l=e.room)||void 0===l?void 0:l.startsWith(null==m?void 0:m.room)}))||(null==a?void 0:a.find(e=>{var l,t,o;return null==e?void 0:null===(o=e.room)||void 0===o?void 0:o.startsWith(null==m?void 0:null===(t=m.room)||void 0===t?void 0:t.substring(0,(null==m?void 0:null===(l=m.room)||void 0===l?void 0:l.indexOf("-"))+4))})),g=null==p?void 0:null===(s=p.times)||void 0===s?void 0:null===(d=s.filter(e=>(null==e?void 0:e.section)===(null==l?void 0:l.number)))||void 0===d?void 0:d.sort((e,l)=>(null==e?void 0:e.time)-(null==l?void 0:l.time))[0];return m?(0,i.jsxs)(r.TableCell,{align:"center",sx:{position:"relative",borderRight:"1px solid rgba(224, 224, 224, 1)"},children:[(0,i.jsx)(u.default,{sx:{position:"absolute",top:5,left:"50%",transform:"translateX(-50%)"},fontSize:12,fontWeight:"bold",children:null==m?void 0:m.room}),(0,i.jsx)(h.default,{sx:{position:"absolute",bottom:5,left:5},children:(0,i.jsx)(r.Tooltip,{title:(null==m?void 0:null===(c=m.groups)||void 0===c?void 0:c.length)>1&&(null==m?void 0:null===(v=m.groups)||void 0===v?void 0:v.join(",")),arrow:!0,placement:"top",children:(0,i.jsx)(r.Chip,{label:(0,i.jsxs)("p",{style:{fontSize:10,fontWeight:"bold"},children:[null==m?void 0:m.groups[0],(null==m?void 0:null===(f=m.groups)||void 0===f?void 0:f.length)>1&&"..."]}),color:"default",size:"small"})})}),(0,i.jsx)(x,{children:(0,i.jsx)(u.default,{fontSize:9,children:m.lessonName})}),(0,i.jsx)(h.default,{sx:{position:"absolute",bottom:5,right:5},children:b(null==g?void 0:g.time,null==g?void 0:g.section,l.start,null==e?void 0:e.date)})]},t):(0,i.jsx)(r.TableCell,{align:"center",sx:{borderRight:"1px solid rgba(224, 224, 224, 1)"},children:" - "},t)})]},l)})})]})})})}}}]);