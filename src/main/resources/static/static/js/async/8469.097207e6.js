/*! For license information please see 8469.097207e6.js.LICENSE.txt */
(self.webpackChunkkiut_client=self.webpackChunkkiut_client||[]).push([["8469"],{808924:function(e,l,n){"use strict";n.r(l);var t=n("258865");n("333948"),n("931672"),n("359461"),n("2490"),n("757658"),n("888449"),n("959849"),n("857640"),n("409924");var i=n("785893"),o=n("667294"),r=n("671893"),a=n("857024"),d=n("752861"),s=n("844118"),u=n("727233"),c=n("316393"),h=n("730381"),m=n.n(h),x=n("332392"),f=n("444025"),v=n("661261"),b=n("742154"),p=n("296413"),j=n("973871"),g=n("314628"),T=n("478951"),C=n("553432"),y=n("516242"),w=n("50533");function S(){let e=(0,t._)(["\n    width: 300px;\n    ","\n"]);return S=function(){return e},e}function D(){let e=(0,t._)(["\n    overflow: hidden;\n    margin: 15px 0 0;\n    padding: 10px 0;\n    display: flex;\n    flex-wrap: wrap;\n    align-items: center;\n    gap: 25px;\n    ","\n"]);return D=function(){return e},e}function k(){let e=(0,t._)(["\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 20px;\n    padding: 1rem;\n\n"]);return k=function(){return e},e}let N=r.default.div(S(),(0,a.extrasmall)({width:"80%"})),R=r.default.div(D(),(0,a.extrasmall)({justifyContent:"center"})),A=r.default.div(k());l.default=()=>{var e,l,n,t,r;let a=(0,w.useSelector)(e=>e.serverTime.time),[h,S]=(0,o.useState)(!1),[D,k]=(0,o.useState)([]),[F,W]=(0,o.useState)([]),[M,z]=(0,o.useState)([]),[_,B]=(0,o.useState)(null),[E,O]=(0,o.useState)((null==M?void 0:null===(e=M.find(e=>(null==e?void 0:e.label)===_))||void 0===e?void 0:e.minFloor)||1),{headers:H}=(0,c.getHeaders)(),[P,I]=(0,o.useState)(null),[Y,L]=(0,o.useState)(!1);(0,o.useEffect)(()=>{a&&I(m()(a))},[a]),(0,o.useEffect)(()=>{u.default.get(c.BASE_URL+"/building/getBuildingsForSelect",{headers:H}).then(e=>{var l,n,t;z(null==e?void 0:null===(l=e.data)||void 0===l?void 0:l.obj),B(null==e?void 0:null===(t=e.data)||void 0===t?void 0:null===(n=t.obj[0])||void 0===n?void 0:n.label)}).catch(e=>{})},[]),(0,o.useEffect)(()=>{S(!1),L(!1),_&&P&&U()},[_,E,P]);let U=()=>{u.default.get(c.BASE_URL+"/timeTableByWeekOfYear/getTimeTableByAllRoomAndWeek?b=".concat(null==_?void 0:_.substring(0,1),"-").concat(E,"&week=").concat(P.isoWeek(),"&weekday=").concat(P.day(),"&year=").concat(P.year(),"&t=true"),{headers:H}).then(e=>{var l;k(e.data.obj),W(null==e?void 0:null===(l=e.data)||void 0===l?void 0:l.secondObj),S(!0),L(!1)}).catch(e=>{L(!0)})};return P&&(0,i.jsxs)(A,{children:[M&&(null==M?void 0:M.length)>0&&(0,i.jsxs)(R,{children:[(0,i.jsx)(N,{children:(0,i.jsx)(s.default,{disablePortal:!0,id:"combo-box-demo",options:M,defaultValue:M[0],onChange:(e,l)=>{B(null==l?void 0:l.label)},renderInput:e=>(0,i.jsx)(d.default,{...e,label:"Buildings"})})}),(0,i.jsx)(N,{children:(0,i.jsxs)(b.default,{fullWidth:!0,children:[(0,i.jsx)(x.default,{id:"demo-simple-select-label",children:"Floor"}),(0,i.jsx)(f.default,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:E,label:"Floor",onChange:e=>{O(e.target.value)},children:null===(n=function(e,l){let n=[];for(;e<=l;e++)n.push(e);return n}(null==M?void 0:null===(t=M.find(e=>(null==e?void 0:e.label)===_))||void 0===t?void 0:t.minFloor,null==M?void 0:null===(r=M.find(e=>(null==e?void 0:e.label)===_))||void 0===r?void 0:r.maxFloor))||void 0===n?void 0:null===(l=n.filter(e=>0!==e))||void 0===l?void 0:l.map(e=>(0,i.jsx)(v.default,{value:e,children:e}))})]})}),(0,i.jsx)(j.LocalizationProvider,{dateAdapter:p.AdapterMoment,children:(0,i.jsx)(g.DesktopDatePicker,{label:"Day",inputFormat:"DD/MM/YYYY",value:P,onChange:e=>{I(m()(e))},renderInput:e=>(0,i.jsx)(d.default,{...e})})})]}),(0,i.jsx)("div",{style:{width:"100%",overflowX:"scroll"},children:h?(0,i.jsx)(y.default,{obj:D,secondObj:F,date:P,serverTime:a}):Y?(0,i.jsx)(T.default,{w:"200",h:"180"}):(0,i.jsx)(C.default,{})})]})}},526457:function(e,l,n){"use strict";n.r(l);var t=n("258865");n("931672"),n("359461"),n("2490"),n("888449"),n("959849"),n("857640"),n("409924");var i=n("785893"),o=n("667294"),r=n("807104"),a=n("671893"),d=n("326178"),s=n("478951"),u=n("730381"),c=n.n(u),h=n("50533"),m=n("405434"),x=n("651649");function f(){let e=(0,t._)(["\n    color: ",";\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 5px;\n"]);return f=function(){return e},e}let v=(0,o.forwardRef)(function(e,l){return(0,i.jsx)(r.Slide,{direction:"up",ref:l,...e})}),b=(0,d.createTheme)({components:{MuiTableCell:{styleOverrides:{root:{justifyContent:"center",textAlign:"center",border:"1px solid #ccc",padding:"10px"}}}}}),p=a.default.span(f(),e=>e.color?"green":"red");l.default=(0,o.memo)(e=>{var l,n,t;let{open:o,handleClose:a,data:u}=e,f=(0,h.useSelector)(e=>e.hourSection),j=e=>{var l,n,t;let o=null==e?void 0:e.login,r=null==e?void 0:e.hourNumber,a=null===(l=f.find(e=>e.number===r))||void 0===l?void 0:l.start,d=null==u?void 0:null===(n=u.enterRoomTimeFilterWithoutLogin)||void 0===n?void 0:n.filter(e=>(null==e?void 0:e.section)===r&&(null==e?void 0:e.login)===o).sort((e,l)=>new Date(e.time)-new Date(l.time));if(!d||0===d.length)return(0,i.jsx)(x.IoMdCloseCircle,{size:20,color:"red"});let s=null===(t=d[0])||void 0===t?void 0:t.time,h=new Date(a).setDate(new Date(s).getDate())>=s;return(0,i.jsxs)(p,{color:h,children:[h?(0,i.jsx)(m.MdOutlineAddCircleOutline,{size:16}):(0,i.jsx)(m.MdRemoveCircleOutline,{size:16}),(0,i.jsx)("p",{children:c()(Math.abs(new Date(a).setDate(new Date(s).getDate())-s)).format("mm:ss")})]})};return o&&(0,i.jsxs)(r.Dialog,{open:o,maxWidth:"md",TransitionComponent:v,keepMounted:!0,onClose:a,"aria-labelledby":"selected-lesson-dialog-title",fullWidth:!0,children:[(0,i.jsxs)(r.DialogTitle,{id:"selected-lesson-dialog-title",children:[null==u?void 0:null===(l=u.lessonFilter[0])||void 0===l?void 0:l.room," ",null==u?void 0:null===(n=u.lessonFilter[0])||void 0===n?void 0:n.periodStartAndEndTime]}),(0,i.jsx)(r.DialogContent,{sx:{padding:"0 5px"},children:(0,i.jsx)(d.ThemeProvider,{theme:b,children:(0,i.jsx)(r.TableContainer,{component:r.Paper,children:(0,i.jsxs)(r.Table,{sx:{minWidth:450},"aria-label":"selected-hour-lessons",children:[(0,i.jsx)(r.TableHead,{children:(0,i.jsxs)(r.TableRow,{children:[(0,i.jsx)(r.TableCell,{children:(0,i.jsx)("b",{children:"Teacher"})}),(0,i.jsx)(r.TableCell,{children:(0,i.jsx)("b",{children:"Subjects"})}),(0,i.jsx)(r.TableCell,{children:(0,i.jsx)("b",{children:"Attendance"})})]})}),(0,i.jsx)(r.TableBody,{children:(null==u?void 0:null===(t=u.lessonFilter)||void 0===t?void 0:t.length)?u.lessonFilter.map((e,l)=>(0,i.jsxs)(r.TableRow,{children:[(0,i.jsx)(r.TableCell,{children:null==e?void 0:e.teacherName}),(0,i.jsx)(r.TableCell,{children:null==e?void 0:e.lessonName}),(0,i.jsx)(r.TableCell,{children:j(e)})]},l)):(0,i.jsx)(r.TableRow,{children:(0,i.jsx)(r.TableCell,{colSpan:3,children:(0,i.jsx)(s.default,{w:200,h:180})})})})]})})})}),(0,i.jsx)(r.DialogActions,{children:(0,i.jsx)(r.Button,{size:"small",variant:"outlined",onClick:a,children:"Close"})})]})})},516242:function(e,l,n){"use strict";n.r(l),n.d(l,{default:function(){return f}});var t=n("258865");n("133792"),n("857640"),n("409924"),n("333948"),n("25387"),n("772608"),n("2490"),n("931672"),n("359461"),n("757658"),n("888449"),n("959849");var i=n("785893"),o=n("667294"),r=n("50533"),a=n("807104"),d=n("671893"),s=n("730381"),u=n.n(s),c=n("503506"),h=n("526457");function m(){let e=(0,t._)(["\n    cursor: pointer;\n    color: #fff;\n    width: 23px;\n    height: 23px;\n    position: absolute;\n    left: 10px;\n    bottom: 10px;\n    font-size: 12px;\n    border-radius: 50%;\n    background-color: rgba(0, 0, 255, 0.75);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    text-align: center;\n    line-height: 1;\n"]);return m=function(){return e},e}function x(){let e=(0,t._)(["\nposition: absolute;\n    bottom: 10px;\n    right: 10px;\n"]);return x=function(){return e},e}function f(e){let{obj:l,secondObj:n,date:t,serverTime:d=new Date().getTime()}=e,s=null==l?void 0:l.flat().map(e=>{var l,n,t;return{teacherId:null===(l=e.teachers[0])||void 0===l?void 0:l.id,teacherName:null===(n=e.teachers[0])||void 0===n?void 0:n.name,login:null===(t=e.teachers[0])||void 0===t?void 0:t.shortName,room:e.room.substring(0,5),lessonName:e.lessonName,hourNumber:e.hourNumber,periodStartAndEndTime:e.periodStartAndEndTime}}).sort((e,l)=>e.room.localeCompare(l.room)),m=n.flat(),x=(0,r.useSelector)(e=>e.hourSection),[f,p]=(0,o.useState)(!1),[j,g]=(0,o.useState)(null),T=e=>{g(e),p(!0)},C=s.reduce((e,l)=>{let n=e.find(e=>e[0].room===l.room);return n?n.push(l):e.push([l]),e},[]),y=(e,l)=>{var n;let t=u()(e),o=u()(null===(n=x.find(e=>e.number===l))||void 0===n?void 0:n.start).date(t.date()).diff(t,"milliseconds"),r=u().utc(Math.abs(o)).format("mm:ss");return o<0?(0,i.jsx)(c.default,{title:t.format("HH:mm"),arrow:!0,children:(0,i.jsx)(a.Chip,{label:r,color:"warning",size:"small"})}):o>0?(0,i.jsx)(c.default,{title:t.format("HH:mm"),arrow:!0,children:(0,i.jsx)(a.Chip,{label:r,color:"success",size:"small"})}):(0,i.jsx)(a.Chip,{label:"On time",color:"default",size:"small"})};return(0,i.jsxs)(a.TableContainer,{component:a.Paper,style:{marginTop:20},children:[(0,i.jsxs)(a.Table,{children:[(0,i.jsx)(a.TableHead,{children:(0,i.jsxs)(a.TableRow,{children:[(0,i.jsx)(a.TableCell,{align:"center",sx:{borderRight:"1px solid rgba(224, 224, 224, 1)",minWidth:"85px"},children:(0,i.jsx)(a.Typography,{variant:"subtitle1",fontWeight:"bold",children:"Time"})}),x.map((e,l)=>(0,i.jsx)(a.TableCell,{align:"center",sx:{borderRight:"1px solid rgba(224, 224, 224, 1)",minWidth:"200px"},children:(0,i.jsx)(a.Typography,{variant:"subtitle2",children:e.hour})},l))]})}),(0,i.jsx)(a.TableBody,{children:C.map((e,l)=>(0,i.jsxs)(a.TableRow,{children:[(0,i.jsx)(a.TableCell,{sx:{borderRight:"1px solid rgba(224, 224, 224, 1)"},children:(0,i.jsx)(a.Typography,{variant:"body1",fontWeight:"medium",children:e[0].room})}),x.map((l,n)=>{let o=e.find(e=>e.hourNumber===l.number),r=e.filter(e=>e.hourNumber===l.number),s=m.filter(l=>l.room===e[0].room&&l.section===(null==o?void 0:o.hourNumber)&&l.login===(null==o?void 0:o.login)).sort((e,l)=>e.time-l.time),c=m.filter(l=>l.room===e[0].room&&l.section===(null==o?void 0:o.hourNumber)),h=u()(t).set({hour:u()(l.start).hours(),minute:u()(l.start).minutes()}),x=u()(d).isAfter(h)&&(s.length>0?y(s[0].time,s[0].section):(0,i.jsx)(a.Chip,{label:"Missed lesson",color:"error",size:"small"}));return(0,i.jsx)(a.TableCell,{align:"center",sx:{borderRight:"1px solid rgba(224, 224, 224, 1)",position:"relative",height:195},children:o?(0,i.jsxs)(i.Fragment,{children:[r.length>1&&(0,i.jsx)(v,{onClick:()=>T({enterRoomTimeFilterWithoutLogin:c,lessonFilter:r}),children:r.length}),(0,i.jsx)(a.Typography,{variant:"body2",fontWeight:"medium",children:o.lessonName}),(0,i.jsx)(a.Typography,{variant:"body2",color:"textSecondary",children:o.teacherName}),(0,i.jsx)(b,{children:x})]}):"-"},n)})]},l))})]}),(0,i.jsx)(h.default,{open:f,handleClose:()=>{p(!1),g(null)},data:j})]})}let v=d.default.span(m()),b=d.default.div(x())}}]);