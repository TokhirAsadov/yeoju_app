{"version":3,"file":"static/js/3945.898a52be.chunk.js","mappings":"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","sources":["components/kafedra/week/KafedraWeek.jsx"],"sourcesContent":["import React, {useEffect, useState} from 'react';\r\nimport {BASE_URL, getHeaders} from \"../../../utills/ServiceUrls\";\r\nimport moment from \"moment\";\r\nimport axios from \"axios\";\r\nimport Autocomplete from \"@mui/material/Autocomplete\";\r\nimport TextField from \"@mui/material/TextField\";\r\nimport TeacherTimeTableOfWeek from \"../../teacher/timeTable/TeacherTimeTableOfWeek\";\r\nimport styled from \"styled-components\";\r\nimport {extrasmall} from \"../../../responsiv\";\r\nimport {useSelector} from \"react-redux\";\r\nimport 'moment/locale/ru';\r\n\r\nconst KafedraWeek = () => {\r\n\r\n  const section = useSelector(state => state?.section?.section);\r\n  const [teachers,setTeachers] = useState([]);\r\n  const [selectTeacherId,setSelectTeacherId] = useState(null);\r\n  const {headers} = getHeaders();\r\n\r\n  const [data,setData] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false)\r\n  const [statistics,setStatistics] = useState(null);\r\n  const getDaysOfWeek = (weekNumber, year) => {\r\n    moment.locale('ru');\r\n    const startDate = moment().year(year).isoWeek(weekNumber).startOf('isoWeek');\r\n    const daysOfWeek = [];\r\n    for (let i = 0; i < 6; i++) {\r\n      daysOfWeek.push(startDate.clone().add(i, 'days').toDate());\r\n    }\r\n    return daysOfWeek;\r\n  };\r\n  const [objWeek, setObjWeek] = useState({\r\n    date: moment().format('YYYY-[W]WW'),\r\n    dateFrom: moment().startOf('isoWeek').toDate(),\r\n    dateTo: moment().endOf('isoWeek').toDate(),\r\n    weekNumber: moment().isoWeek(),\r\n    daysOfWeek:getDaysOfWeek(moment().isoWeek(),moment().year()),\r\n  });\r\n\r\n  const onChange = (event) => {\r\n    const date=event.target.value\r\n    const weekNumber = moment(date).isoWeek();\r\n    const dateFrom = moment(date).startOf('isoWeek').toDate();\r\n    const dateTo = moment(date).endOf('isoWeek').toDate();\r\n    const dateYear=moment(date).year()\r\n\r\n    setObjWeek({\r\n      date,\r\n      dateFrom,\r\n      dateTo,\r\n      weekNumber,\r\n      daysOfWeek:getDaysOfWeek(weekNumber,dateYear)\r\n    })\r\n  }\r\n\r\n\r\n\r\n  useEffect(()=>{\r\n    section?.id && axios.get(BASE_URL+\"/kafedra/getTeachersForSelectByKafedraId?kafedraId=\"+section?.id,{headers})\r\n      .then(res => {\r\n        setTeachers(res?.data?.obj)\r\n      })\r\n      .catch(err => {\r\n        console.log(err)\r\n      })\r\n  },[])\r\n\r\n  useEffect(() => {\r\n    setIsLoading(true)\r\n    selectTeacherId && axios.get(BASE_URL+\"/timeTableByWeekOfYear/getTeacherTimeTable?t=\"+selectTeacherId+\"&week=\"+objWeek?.weekNumber+\"&year=\"+moment(objWeek?.date).format(\"YYYY\"),{headers})\r\n      .then(res=>{\r\n        const resultData = res?.data?.obj\r\n\r\n        const convertDate = [];\r\n\r\n        const showGroups = {};\r\n\r\n        resultData?.forEach((item) => {\r\n          item.shows.forEach((show) => {\r\n            const key = show.daysName;\r\n            if (!showGroups[key]) {\r\n              showGroups[key] = {\r\n                teacherData: item.teacherData,\r\n                shows: [],\r\n              };\r\n            }\r\n            showGroups[key].shows.push(show);\r\n          });\r\n        });\r\n\r\n        for (const key in showGroups) {\r\n          convertDate.push(showGroups[key]);\r\n        }\r\n        setData(convertDate)\r\n        setIsLoading(false)\r\n      })\r\n      .catch(err => {\r\n        console.log(err)\r\n        setData([])\r\n      })\r\n\r\n    selectTeacherId && fetchStatistics(selectTeacherId);\r\n\r\n  },[selectTeacherId,objWeek])\r\n\r\n  const fetchStatistics = (teacherId) => {\r\n    axios.get(BASE_URL+\"/user/getTeacherStatisticsForTimeTableByWeek?teacherId=\"+teacherId+\"&week=\"+objWeek?.weekNumber+\"&year=\"+moment(objWeek?.date).format(\"YYYY\"), {headers})\r\n      .then(res => {\r\n        setStatistics(res?.data?.obj);\r\n      })\r\n      .catch(err => {\r\n        console.log(err)\r\n        setStatistics(null)\r\n      })\r\n  }\r\n\r\n  return (\r\n    <Container>\r\n\r\n      <Wrapperinput>\r\n        <Selectbox>\r\n          <Autocomplete\r\n            disablePortal\r\n            id=\"combo-box-demo\"\r\n            options={ teachers }\r\n            onChange={(event, newValue) => {\r\n              setSelectTeacherId(newValue?.value)\r\n            }}\r\n\r\n            sx={{ width: 300 }}\r\n            renderInput={(params) => <TextField {...params} label=\"Teacher\" />}\r\n          />\r\n        </Selectbox>\r\n\r\n        <TextField\r\n            label=\"Date of the week\"\r\n            type=\"week\"\r\n            sx={{width: \"200px\"}}\r\n            value={objWeek.date}\r\n            onChange={onChange}\r\n        />\r\n      </Wrapperinput>\r\n\r\n      {\r\n        selectTeacherId && <TeacherTimeTableOfWeek isLoading={isLoading} obj={objWeek} data={data} statistics={statistics}/>\r\n      }\r\n    </Container>\r\n  );\r\n};\r\n\r\n\r\nconst Selectbox = styled.div`\r\n  width: 300px;\r\n  ${extrasmall({\r\n  width:\"80%\"\r\n})}\r\n`\r\nconst Wrapperinput = styled.div`\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  align-items: center;\r\n  gap: 25px;\r\n  margin-bottom: 1rem;\r\n  ${extrasmall({\r\n  justifyContent:\"center\"\r\n})}\r\n`\r\n\r\nconst Container = styled.div`\r\n  width: 100%;\r\n  padding: 1rem;\r\n`\r\n\r\nexport default KafedraWeek;"],"names":["Selectbox","styled","extrasmall","width","Wrapperinput","justifyContent","Container","section","useSelector","state","useState","teachers","setTeachers","selectTeacherId","setSelectTeacherId","headers","getHeaders","data","setData","isLoading","setIsLoading","statistics","setStatistics","getDaysOfWeek","weekNumber","year","moment","startDate","isoWeek","startOf","daysOfWeek","i","push","clone","add","toDate","date","format","dateFrom","dateTo","endOf","objWeek","setObjWeek","useEffect","id","axios","BASE_URL","then","res","obj","catch","err","console","log","resultData","convertDate","showGroups","key","forEach","item","shows","show","daysName","teacherData","fetchStatistics","teacherId","disablePortal","options","onChange","event","newValue","value","sx","renderInput","params","label","type","target","dateYear"],"sourceRoot":""}